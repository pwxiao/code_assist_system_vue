import{aA as C,aB as V,N as d,H as q,aa as R,aC as I,c as a,aw as t,aD as T,aE as P,av as Q,aF as B,ay as F,az as l,aG as v,aH as M,aI as j,aJ as D}from"./index-Cppn8EGc.js";import{M as E,j as H,o as N,V as $,a as w}from"./VTextarea-BhFZ_NIl.js";import{_ as x,V as L,c as k}from"./loader-BjlEvZIp.js";const O=C({components:{Codemirror:V},setup(){const e=d("console.log('Hello, world!')"),s=d(!1),n=d("Hello, **world**! 你好！我将竭力回答你的问题"),c=d([]),g=(o,p="user")=>{c.value.push({text:o,sender:p})},_=new E,u=q(()=>_.render(n.value)),i=[H(),N],b=R();return{code:e,extensions:i,handleReady:o=>{b.value=o.view},aiResponse:n,sendQuery:async()=>{console.log(c),s.value=!0,n.value="";const o=document.getElementById("userQueryInput").value;console.log("Sending query: ",o);const y=`https://flask-hello-world-alpha-gilt.vercel.app/api/ask?${new URLSearchParams({query:o}).toString()}`;try{const r=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"根据这段代码："+e.value+","+o})});if(!r.body)throw new Error("Failed to get readable stream.");const m=r.body.getReader();for(;s.value;){const{done:h,value:f}=await m.read();if(h)break;n.value+=new TextDecoder().decode(f)}}catch(r){console.error("Failed to send query: ",r),n.value="Failed to fetch response."}finally{s.value=!1}},analyse:async()=>{s.value=!0,n.value="";const o=document.getElementById("userQueryInput").value;console.log("Sending query: ",o);const y=`https://flask-hello-world-alpha-gilt.vercel.app/api/ask?${new URLSearchParams({query:o}).toString()}`;try{const r=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"解释这段代码："+e.value})});if(!r.body)throw new Error("Failed to get readable stream.");const m=r.body.getReader();for(;s.value;){const{done:h,value:f}=await m.read();if(h)break;n.value+=new TextDecoder().decode(f)}}catch(r){console.error("Failed to send query: ",r),n.value="Failed to fetch response."}finally{s.value=!1}g(o,"user")},renderedMarkdown:u,stopStreaming:()=>{s.value=!1},log:console.log}}}),S=e=>(j("data-v-707e654d"),e=e(),D(),e),A=S(()=>l("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css"},null,-1)),J={class:"pa-3",style:{height:"80vh"}},U={class:"mt-3"},z=S(()=>l("p",null,"编程助手:",-1)),G=["innerHTML"];function K(e,s,n,c,g,_){const u=P("codemirror");return Q(),I("div",null,[A,a(T,null,{default:t(()=>[a(B,null,{default:t(()=>[a(F,{fluid:""},{default:t(()=>[a(L,null,{default:t(()=>[a(k,{cols:"6"},{default:t(()=>[a(u,{modelValue:e.code,"onUpdate:modelValue":s[0]||(s[0]=i=>e.code=i),extensions:e.extensions,onReady:e.handleReady},null,8,["modelValue","extensions","onReady"])]),_:1}),a(k,{cols:"6"},{default:t(()=>[l("div",J,[a($,{id:"userQueryInput",label:"提问",rows:"2",outlined:""}),a(w,{onClick:e.analyse,color:"blue"},{default:t(()=>[v("解释代码")]),_:1},8,["onClick"]),a(w,{onClick:e.sendQuery},{default:t(()=>[v("发送")]),_:1},8,["onClick"]),a(w,{onClick:e.stopStreaming,color:"red"},{default:t(()=>[v("停止")]),_:1},8,["onClick"]),a(M),l("div",U,[z,l("div",{class:"markdown-body",innerHTML:e.renderedMarkdown},null,8,G)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const se=x(O,[["render",K],["__scopeId","data-v-707e654d"]]);export{se as default};

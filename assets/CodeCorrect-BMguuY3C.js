import{aA as b,aB as V,N as d,H as q,aa as R,aC as I,c as a,aw as r,aD as T,aE as P,av as Q,aF as B,ay as F,az as l,aG as v,aH as M,aI as j,aJ as D}from"./index-Cppn8EGc.js";import{M as E,j as H,o as N,V as $,a as w}from"./VTextarea-BhFZ_NIl.js";import{_ as x,V as L,c as k}from"./loader-BjlEvZIp.js";const O=b({components:{Codemirror:V},setup(){const e=d("console.log('Hello, world!')"),s=d(!1),n=d("Hello, **world**! 你好！我将竭力回答你的问题"),c=d([]),g=(o,p="user")=>{c.value.push({text:o,sender:p})},_=new E,u=q(()=>_.render(n.value)),i=[H(),N],S=R();return{code:e,extensions:i,handleReady:o=>{S.value=o.view},aiResponse:n,sendQuery:async()=>{console.log(c),s.value=!0,n.value="";const o=document.getElementById("userQueryInput").value;console.log("Sending query: ",o);const y=`http://localhost:5000/api/ask?${new URLSearchParams({query:o}).toString()}`;try{const t=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"根据这段代码："+e.value+","+o})});if(!t.body)throw new Error("Failed to get readable stream.");const m=t.body.getReader();for(;s.value;){const{done:f,value:h}=await m.read();if(f)break;n.value+=new TextDecoder().decode(h)}}catch(t){console.error("Failed to send query: ",t),n.value="Failed to fetch response."}finally{s.value=!1}},analyse:async()=>{s.value=!0,n.value="";const o=document.getElementById("userQueryInput").value;console.log("Sending query: ",o);const y=`http://localhost:5000/api/ask?${new URLSearchParams({query:o}).toString()}`;try{const t=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"纠正这段代码："+e.value})});if(!t.body)throw new Error("Failed to get readable stream.");const m=t.body.getReader();for(;s.value;){const{done:f,value:h}=await m.read();if(f)break;n.value+=new TextDecoder().decode(h)}}catch(t){console.error("Failed to send query: ",t),n.value="Failed to fetch response."}finally{s.value=!1}g(o,"user")},renderedMarkdown:u,stopStreaming:()=>{s.value=!1},log:console.log}}}),C=e=>(j("data-v-a237efef"),e=e(),D(),e),J=C(()=>l("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css"},null,-1)),U={class:"pa-3",style:{height:"80vh"}},A={class:"mt-3"},z=C(()=>l("p",null,"编程助手:",-1)),G=["innerHTML"];function K(e,s,n,c,g,_){const u=P("codemirror");return Q(),I("div",null,[J,a(T,null,{default:r(()=>[a(B,null,{default:r(()=>[a(F,{fluid:""},{default:r(()=>[a(L,null,{default:r(()=>[a(k,{cols:"6"},{default:r(()=>[a(u,{modelValue:e.code,"onUpdate:modelValue":s[0]||(s[0]=i=>e.code=i),extensions:e.extensions,onReady:e.handleReady},null,8,["modelValue","extensions","onReady"])]),_:1}),a(k,{cols:"6"},{default:r(()=>[l("div",U,[a($,{id:"userQueryInput",label:"提问",rows:"2",outlined:""}),a(w,{onClick:e.analyse,color:"blue"},{default:r(()=>[v("纠正代码")]),_:1},8,["onClick"]),a(w,{onClick:e.sendQuery},{default:r(()=>[v("发送")]),_:1},8,["onClick"]),a(w,{onClick:e.stopStreaming,color:"red"},{default:r(()=>[v("停止")]),_:1},8,["onClick"]),a(M),l("div",A,[z,l("div",{class:"markdown-body",innerHTML:e.renderedMarkdown},null,8,G)])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const se=x(O,[["render",K],["__scopeId","data-v-a237efef"]]);export{se as default};
